# =========================================================
# TrendAgent Environment Template
# Copy to .env and fill secrets before deployment
# =========================================================

# =========================
# App
# =========================
APP_ENV=development
DEBUG=true
PORT=8090

# =========================
# Auth
# =========================
JWT_SECRET=replace-with-a-long-random-secret
AUTH_TOKEN_EXPIRES_SECONDS=86400
AUTH_REGISTRATION_ENABLED=true
AUTH_DB_PATH=trend_auth_users.db

# =========================
# Orchestration
# =========================
LANGGRAPH_REQUIRED=false
CHECKPOINT_AUTO_SAVE=true
CHECKPOINT_STORE=memory

# =========================
# LLM (primary + fallback)
# =========================
LLM_PRIMARY_BACKEND=zhipu
ZHIPU_API_KEY=
ZHIPU_BASE_URL=https://open.bigmodel.cn/api/paas/v4
ZHIPU_MODEL=glm-4-flash

OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini

OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=qwen2.5:7b

LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=2048
LLM_RETRY_MAX_ATTEMPTS=3
LLM_RETRY_BASE_DELAY_SECONDS=0.5
LLM_TIMEOUT_SECONDS=60
LLM_FALLBACK_ENABLED=true
LLM_FALLBACK_BACKEND=ollama

# =========================
# Scrapers
# =========================
SCRAPER_ENABLED_SOURCES=twitter,youtube,weibo,bilibili,zhihu,github
SCRAPER_TIMEOUT_SECONDS=30
CONCURRENT_SCRAPERS=5
SCRAPER_COORDINATION_BACKEND=memory
SCRAPER_REDIS_URL=redis://127.0.0.1:6379/0
SCRAPER_REDIS_KEY_PREFIX=trend_agent:scraper
SCRAPER_REDIS_POP_TIMEOUT_SECONDS=1.0
SCRAPER_QUEUE_MAX_SIZE=200
SCRAPER_QUEUE_ENQUEUE_TIMEOUT_SECONDS=1.0
SCRAPER_RETRY_MAX_ATTEMPTS=3
SCRAPER_RETRY_BASE_DELAY_SECONDS=0.5
SCRAPER_CIRCUIT_BREAKER_FAILURE_THRESHOLD=3
SCRAPER_CIRCUIT_BREAKER_OPEN_SECONDS=30
# JSON or csv style:
# SCRAPER_SOURCE_RPS={"github":1.0,"twitter":2.0}
# SCRAPER_SOURCE_RPS=github=1.0,twitter=2.0
SCRAPER_SOURCE_RPS=

TWITTER_BEARER_TOKEN=
TWITTER_MAX_RESULTS=100

YOUTUBE_API_KEY=
YOUTUBE_MAX_RESULTS=50
YOUTUBE_REGION_CODE=US

WEIBO_ACCESS_TOKEN=
BILIBILI_SESSDATA=
ZHIHU_COOKIE=
GITHUB_TOKEN=
GITHUB_API_BASE_URL=https://api.github.com

# =========================
# Publishers
# =========================
WECHAT_APP_ID=
WECHAT_APP_SECRET=
XIAOHONGSHU_COOKIE=
DOUYIN_ACCESS_TOKEN=
WEIBO_PUBLISH_TOKEN=

PUBLISH_RETRY_MAX=3
PUBLISH_RETRY_DELAY=5

# =========================
# Video Generation
# =========================
VIDEO_DEFAULT_PROVIDER=keling
VIDEO_FALLBACK_ENABLED=true
VIDEO_POLL_INTERVAL=10
VIDEO_POLL_MAX_WAIT=600

KELING_ACCESS_KEY=
KELING_SECRET_KEY=
KELING_BASE_URL=https://api.klingai.com/v1

RUNWAY_API_KEY=
RUNWAY_BASE_URL=https://api.dev.runwayml.com/v1

PIKA_API_KEY=
PIKA_BASE_URL=https://api.pika.art/v1

# =========================
# Quality
# =========================
SENSITIVE_WORD_LIST=
QUALITY_MIN_BODY_LENGTH=100
QUALITY_MAX_SIMILARITY=0.85
QUALITY_LLM_REVIEW=false

# =========================
# Database
# SQLite default for dev. Example Postgres:
# DATABASE_URL=postgresql+asyncpg://user:pass@postgres:5432/trend_agent
# =========================
DATABASE_URL=sqlite+aiosqlite:///data/trend_agent.db
DB_ECHO=false
DB_POOL_SIZE=10

# =========================
# Scheduler
# =========================
SCHEDULER_ENABLED=true
SCHEDULER_TIMEZONE=Asia/Shanghai
SCHEDULER_MISFIRE_GRACE=300

# =========================
# Media
# =========================
MEDIA_BACKEND=local
MEDIA_LOCAL_PATH=./media

MEDIA_S3_BUCKET=
MEDIA_S3_ENDPOINT=
MEDIA_S3_ACCESS_KEY=
MEDIA_S3_SECRET_KEY=

# =========================
# Multimodal Enrichment
# =========================
MULTIMODAL_ENABLED=false
MULTIMODAL_ENRICH_TOP_N=10
MULTIMODAL_MAX_MEDIA_PER_ITEM=2
MULTIMODAL_MIN_HEAT_SCORE=0.35

# =========================
# Heat Score
# =========================
HEAT_WEIGHT_PLATFORM_PERCENTILE=0.45
HEAT_WEIGHT_VELOCITY=0.25
HEAT_WEIGHT_FRESHNESS=0.20
HEAT_WEIGHT_CROSS_PLATFORM=0.10
HEAT_FRESHNESS_HALF_LIFE_HOURS=24
HEAT_FRESHNESS_MAX_AGE_HOURS=168
HEAT_GITHUB_WEIGHT_STAR_VELOCITY=0.45
HEAT_GITHUB_WEIGHT_CONTRIBUTOR_ACTIVITY=0.35
HEAT_GITHUB_WEIGHT_RELEASE_ADOPTION=0.20
HEAT_GITHUB_STAR_VELOCITY_NORM_CAP=200
HEAT_GITHUB_CONTRIBUTOR_ACTIVITY_NORM_CAP=400
HEAT_GITHUB_RELEASE_ADOPTION_NORM_CAP=50000
HEAT_GITHUB_BOOST_BASE=0.75
HEAT_GITHUB_BOOST_RANGE=0.50
# JSON or csv style:
# HEAT_PLATFORM_WEIGHTS={"twitter":1.0,"youtube":1.1}
# HEAT_PLATFORM_WEIGHTS=twitter=1.0,youtube=1.1,weibo=0.9
HEAT_PLATFORM_WEIGHTS=

# =========================
# Parse
# =========================
PARSE_ENABLED=true
PARSE_SCHEMA_VERSION=v1
PARSE_BACKEND=heuristic
PARSE_CACHE_ENABLED=true
PARSE_MAX_ATTEMPTS_PER_RUN=2
PARSE_LOW_CONFIDENCE_THRESHOLD=0.65
PARSE_LOW_CONFIDENCE_RETRY_ATTEMPTS=1
PARSE_LOW_CONFIDENCE_MANUAL_AFTER_ATTEMPTS=3
PARSE_RECOVERABLE_MAX_ATTEMPTS=5
PARSE_RETRY_BASE_DELAY_SECONDS=60
PARSE_RETRY_MAX_DELAY_SECONDS=1800
PARSE_BATCH_SIZE=20

# =========================
# Monitoring
# =========================
GF_SECURITY_ADMIN_PASSWORD=admin123
